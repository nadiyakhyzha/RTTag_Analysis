# The following was used for generating Extended Data Figure 3A. Values for plotting were obtained from QualiMap RNA-Seq QC. 
# For K27me3

exonic<- 4758527
intronic<- 2224669 
intergenic<- 2031558

# These corresponded to the following percentages: 
# Exonic: 	4,758,527 / 52.79%
# Intronic: 	2,224,669 / 24.68%
# Intergenic: 	2,031,558 / 22.54%

# Values were plotted as a pie chart.
combined<- list(exonic, intronic, intergenic)
names(combined)<- c("exonic 53%", "intronic 25%", "intergenic 22%")

pdf("PieChart_read_distribution_K27me3_RTTag.pdf", 6,5)
pie(unlist(combined), labels = names(combined), main="Distribution of K27me3 RT&Tag reads", col =c("black", "grey", "white"), cex=1.2, cex.main=1.5)
dev.off()




# For m6A

exonic<- 4439719
intronic<- 1102170 
intergenic<- 1212728

# These corresponded to the following percentages: 
# Exonic: 	3,667,532 / 70.15%
# Intronic: 	636,022 / 12.16%
# Intergenic: 	924,833 / 17.69%

# Values were plotted as a pie chart.
combined<- list(exonic, intronic, intergenic)
names(combined)<- c("exonic 70%", "intronic 12%", "intergenic 18%")

pdf("PieChart_read_distribution_m6A_RTTag.pdf", 6,5)
pie(unlist(combined), labels = names(combined), main="Distribution of m6A RT&Tag reads", col =c("black", "grey", "white"), cex=1.2, cex.main=1.5)
dev.off()


#----------------------------------------------------------------------------------------------------------------------------------------------------
# The following was used for generating Extended Data Figure 3B. Values for plotting were obtained from RSeQC. Plot as density plot.

# For K27me3 RT&Tag

pdf('K27me3_RT&Tag.geneBodyCoverage.pdf')
x=1:100
y=c(15625.178439438343,17272.158213168383,18316.16419097781,19374.70415955782,20461.723521515727,21683.88509938121,21171.90435037017,21241.12273031473,23154.494238466024,26889.86179473996,28684.855276167393,42532.18303768337,42752.8609290123,50285.948227494955,50874.50570972264,54941.6008207649,51640.57987129688,51389.641904607415,44908.146594300866,42769.56950992346,40588.119009792805,33385.84954914451,34583.421734809875,30329.981278553605,30942.897762209177,31867.061042010784,37975.95959798992,38020.53689907491,38072.25448730588,36343.34468668699,34060.26380647719,36884.12243834138,37912.621546536684,40894.9056071192,41552.019969284534,40761.597180739045,40201.26896415651,40511.04840052128,41091.16971287131,41349.346383690834,46116.72876274586,49785.84529846907,48926.044519886374,46397.81370949745,50507.646593526006,50758.811689168215,51458.3492911011,55632.259217083454,55846.175914004445,55988.107830286026,55563.28962865472,52675.45569960773,52166.119359105825,52184.877966955304,51728.39307783544,53545.7489798069,53790.36352349818,52471.26637476683,57393.778558164835,62558.372835978866,66644.21513348818,65805.75693377852,63599.24052229524,67830.42637436092,70074.7122156471,68422.54049555957,69356.4806112051,72903.37274235487,69313.20198898017,71120.76996685565,75764.84230434895,77895.42326766253,80336.39198593795,83655.80219531059,87695.22181078792,91765.22789782286,95356.15597857535,98927.9085830003,104715.96797212958,113269.4424636066,116109.23476804793,116647.64584460855,119093.04727943242,128621.53283511102,132356.1977855265,135707.3306027949,139247.57134485245,145319.82964400947,150304.42812983692,158753.39803133905,162809.66863040626,167073.29073420167,172762.44529481232,180127.46252956986,184741.6058306098,189932.83516936004,194566.0513061881,185567.91178905964,167549.533943519,120932.18131870031)
plot(x,y/36294,xlab="percentile of gene body (5'->3')",ylab='average wigsum',type='h', lwd=6, cex.axis=1.5, cex.lab= 1.5, main="K27me3 RT&Tag")
dev.off()


# for m6A RT&Tag

pdf('m6A_RT&Tag.geneBodyCoverage.pdf')
x=1:100
y=c(15752.174835145473,19114.024211391807,21120.970406010747,22950.811545297503,24750.337298095226,26269.487745076418,25250.120274290442,24891.918284490705,27506.530084356666,32785.00512200594,34527.19767636061,57472.971888676286,57695.328553661704,71000.17664319277,71647.61579197645,78145.1332000643,72684.33503629267,71471.62023663521,61050.1078389287,58636.77906061709,54589.52487567067,42310.28668169677,45426.239622190595,35817.20928798616,36746.76851327717,37741.286592543125,47541.24744769931,46602.39065179229,45784.190664187074,41922.91110549867,37333.749793857336,45175.76242505014,46706.63672837615,53819.960302352905,59312.11700500548,58157.442146643996,56032.43339082599,56601.097406089306,54566.943082764745,51989.441841989756,62367.34626559913,70689.73813715577,64669.498504295945,63115.093585163355,69078.62895846367,66997.92926971614,66577.94489015639,71972.79968431592,70249.71690492332,67657.44554565847,66042.83922621608,59822.90821440518,58765.58536401391,56945.91631361842,55736.152708247304,57308.19076013565,57588.83085307479,56386.105871498585,65413.285125911236,66684.10666850209,73539.55930685997,73080.16912296414,73118.22123531997,75281.34569631517,78872.05235978961,78793.79562805593,78900.79635608196,81805.69221666455,76488.05199819803,78897.4071507752,86777.53674818575,89102.90354706347,92688.75873158872,97960.61458066106,104080.3035877347,110240.38146625459,114548.37594333291,119087.75775904953,127430.33088387549,138466.78756460547,141842.70086568594,144026.23211237788,149431.32204437256,165650.97254033387,171287.118608132,173275.94064991176,178234.4132078439,186593.12690912187,195856.56271901727,213352.06525337696,220125.98181311786,227975.03131209314,236775.31846657395,245376.87576062977,247838.42761340737,252914.84156765044,253954.8855239302,236225.11435471475,206265.69999045134,138342.48212243617)
plot(x,y/36294,xlab="percentile of gene body (5'->3')",ylab='average wigsum',type='h', lwd=6, cex.axis=1.5, cex.lab= 1.5, main="m6A RT&Tag")
dev.off()

